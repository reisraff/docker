#!/usr/bin/env python

import sys
import os

help_message = """
RUN-CONTAINER

Usage:
    {} [container-name]
"""

if 2 != len(sys.argv):
    sys.stderr.write(help_message.format(sys.argv[0]))
    sys.stderr.flush()
    sys.exit(1)

container_name = sys.argv[1]
docker_compose_bin_folder = os.path.dirname(os.path.realpath(__file__))
docker_compose_folder = os.path.dirname(docker_compose_bin_folder)
docker_compose_filename = 'docker-compose.yml'
docker_compose_file_path = os.path.realpath(os.path.join(docker_compose_folder, docker_compose_filename))
cwd = os.path.realpath(os.getcwd())

command = 'docker-compose -f {} run --rm -e DISPLAY={} -v /tmp/.X11-unix:/tmp/.X11-unix -v {}:/workdir -w /workdir {} bash'.format(
    docker_compose_file_path,
    os.environ['DISPLAY'],
    cwd,
    container_name
)

os.system(command)
